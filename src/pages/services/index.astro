---
import Layout from '../../layouts/Layout.astro';
import Navbar from '../../components/Navbar.astro';
import Footer from '../../components/Footer.astro';
import Contact from '../../components/sections/common/Contact.astro';
import Feature from '../../components/sections/homepage/Feature.astro';
import Testimonials from '../../components/sections/common/Testimonials.astro';

const seoConfig = {
  title: "Services | SMICE",
  description: "Pilotez la qualité et l'expérience client avec les services Smice. Mesurer, comparer et améliorer la qualité opérationnelle.",
  keywords: ["SMICE", "services", "qualité", "expérience client", "audit", "visite mystère"],
};

const steps = [
  {
    number: 1,
    title: "Conseil & Conception du Questionnaire",
    description: "Nous accompagnons vos équipes dans la définition des objectifs, la construction des questionnaires, la création des items, scénarios et critères pour garantir des évaluations pertinentes et adaptées à vos enjeux.",
    objectifs: [
      "Définition des objectifs & KPIs",
      "Conception ou optimisation du questionnaire",
      "Alignement avec vos standards opérationnels"
    ],
    image: "/images/services/solution/step1.png"
  },
  {
    number: 2,
    title: "Sélection des Smiceurs",
    description: "Nous identifions dans notre communauté les profils les plus adaptés à vos besoins selon plusieurs critères : Proximité géographique, expérience du secteur concerné, qualité et fiabilité des enquêtes précédentes.",
    objectifs: [
      "Garantir des audits cohérents",
      "Réalisés par des profils fiables et représentatifs de vos clients réels."
    ],
    image: "/images/services/solution/step2.png"
  },
  {
    number: 3,
    title: "Attribution des missions",
    description: "Une fois les profils sélectionnés, Smice attribue à chaque Smiceur la mission adaptée à son expertise :\n• Mission de conformité pour vérifier le respect des standards et procédures.\n• Mission d'expérience (visite mystère) pour évaluer la qualité perçue du point de vue client.\n• Mission d'audit opérationnelle pour mesurer la cohérence et la performance opérationnelle.\n• Toutes les missions sont centralisées et suivies via la Smice App, qui permet d'assurer le bon déroulement et la traçabilité complète de chaque étape sur le terrain.",
    objectifs: [
      "Garantir que chaque mission soit réalisée par le bon profil, au bon endroit, au bon moment."
    ],
    image: "/images/services/solution/step3.png"
  },
  {
    number: 4,
    title: "Réalisation sur le terrain",
    description: "Les Smiceurs exécutent les missions selon vos standards : observation terrain, reporting en temps réel, respect des protocoles d'évaluation.\nLes données collectées sont immédiatement intégrées dans la Smice App, garantissant une traçabilité totale.",
    objectifs: [
      "Des données fiables, précises et exploitables dès la fin de la mission."
    ],
    image: "/images/services/solution/step4.png"
  },
  {
    number: 5,
    title: "Analyse et restitution sur la plateforme Smice",
    description: "Tous les résultats sont consolidés sur votre tableau de bord Smice. Vous pouvez suivre :\n• Les indicateurs de performance qualité.\n• Les écarts par établissement ou région.\n• L'évolution de vos plans d'action.",
    objectifs: [
      "Une vision 360° de la qualité opérationnelle et de l'expérience client, accessible en temps réel."
    ],
    image: "/images/services/solution/step5.png"
  }
];
---

<Layout 
  title={seoConfig.title}
  description={seoConfig.description}
  keywords={seoConfig.keywords}
>
  <Navbar currentPath="/services" backgroundColor="white" />
  
  <main>
    <!-- Hero Section -->
    <section class="services-hero">
      <div class="hero-banner">
        <div class="hero-overlay"></div>
        <div class="hero-content">
          <h1 class="hero-title">
            Pilotez la <span class="highlight">qualité<img src="/images/services/hero-section/subline_qualité.png" alt="" class="subline-img" /></span> et <span class="highlight">l'expérience client<img src="/images/services/hero-section/subline-expérience.png" alt="" class="subline-img" /></span><br />avec les services Smice
          </h1>
          <p class="hero-description">
            Smice aide les réseaux multisites à mesurer, comparer et améliorer la qualité 
            opérationnelle et l'expérience vécue par les clients.<br />
            Nos services combinent interventions terrain et pilotage data via la Smice App 
            pour passer rapidement de l'observation à l'action.
          </p>
          <a href="#solution" class="hero-cta">
            Découvrir nos services
          </a>
        </div>
      </div>
    </section>

    <!-- Solution Section -->
    <section id="solution" class="solution-section">
      <div class="solution-container">
        <h2 class="solution-title">
          Découvrez notre <span class="solution-highlight">solution<img src="/images/services/solution/subline-solution.png" alt="" class="subline-img" /></span>
        </h2>

        <div class="carousel-wrapper">
          <button class="carousel-btn prev-btn" aria-label="Étape précédente">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="m15 18-6-6 6-6"/>
            </svg>
          </button>

          <div class="steps-carousel">
            <div class="steps-track">
              {steps.map((step, index) => (
                <div class="step-slide" data-index={index}>
                  <div class="step-image">
                    <div class="image-wrapper">
                      <img src={step.image} alt={step.title} />
                    </div>
                  </div>
                  <div class="step-content">
                    <span class="step-label">Étape {step.number}</span>
                    <h3 class="step-title" set:html={step.title} />
                    <div class="step-description">
                      <p set:html={step.description.replace(/\n/g, '<br/>')} />
                    </div>
                    <div class="objectif-section">
                      <p class="objectif-text"><span class="objectif-highlight">Objectif</span> :</p>
                      <ul class="step-bullets">
                        {step.objectifs.map((objectif) => (
                          <li>• {objectif}</li>
                        ))}
                      </ul>
                    </div>
                  </div>
                </div>
              ))}
            </div>
          </div>

          <button class="carousel-btn next-btn" aria-label="Étape suivante">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="m9 18 6-6-6-6"/>
            </svg>
          </button>
        </div>

        <div class="carousel-dots">
          {steps.map((_, index) => (
            <button class={`dot ${index === 0 ? 'active' : ''}`} data-index={index} aria-label={`Aller à l'étape ${index + 1}`}></button>
          ))}
        </div>
      </div>
    </section>

    <!-- Smice s'interconnecte -->
    <Feature />

    <!-- Benefits: Audits -->
    <section class="benefits-section" id="benefit-audits" style="background-color: #F4F7FF;">
      <div class="benefits-container">
        <h2 class="benefits-title" style="color: #504C54;">
          Pour vos <span class="benefit-highlight" style="color: #6989D4;">standards<img src="/images/services/benefits-section/subline-standards.png" alt="" class="subline-img" /></span> : des <span class="benefit-highlight" style="color: #6989D4;">audits<img src="/images/services/benefits-section/subline-audits.png" alt="" class="subline-img" /></span> fiables et précis
        </h2>
        <div class="benefits-content image-left">
          <div class="benefits-text">
            <h3 class="section-title">Audits internes & audits opérationnels</h3>
            <p class="description">Avec Smice, vous combinez audits internes et externes pour un pilotage qualité complet.</p>
            <p class="description">La Smice App permet à vos équipes de réaliser des contrôles homogènes sur tout le réseau.</p>
            <p class="description">Nos auditeurs externes apportent un regard expert pour une vision fiable et exploitable de votre performance.</p>
            <a href="/services/audit" class="btn-benefit" style="background-color: #6989D4;">En savoir plus</a>
          </div>
          <div class="benefits-image">
            <img src="/images/services/benefits-section/audits.png" alt="Audits internes et opérationnels" />
          </div>
        </div>
      </div>
    </section>

    <!-- Benefits: Auto-évaluation -->
    <section class="benefits-section" id="benefit-1" style="background-color: #F3EFF6;">
      <div class="benefits-container">
        <h2 class="benefits-title" style="color: #504C54;">
          Pour vos <span class="benefit-highlight" style="color: #9B8AAD;">équipes<img src="/images/services/benefits-section/subline-équipes.png" alt="" class="subline-img" /></span> : un <span class="benefit-highlight" style="color: #9B8AAD;">outil<img src="/images/services/benefits-section/subline-outil.png" alt="" class="subline-img" /></span> d'engagement et de progression
        </h2>
        <div class="benefits-content">
          <div class="benefits-text">
            <h3 class="section-title">Auto-évaluation interne</h3>
            <p class="description">L'auto-évaluation Smice engage vos équipes dans une démarche active de qualité. Chaque collaborateur peut évaluer ses propres pratiques, suivre ses progrès et contribuer à l'amélioration continue.</p>
            <p class="description">Cet outil renforce la culture qualité au quotidien et valorise la responsabilisation sur le terrain.</p>
            <a href="/services/auto-evaluation" class="btn-benefit" style="background-color: #9B8AAD;">En savoir plus</a>
          </div>
          <div class="benefits-image">
            <img src="/images/services/benefits-section/auto-évaluation.png" alt="Auto-évaluation interne" />
          </div>
        </div>
      </div>
    </section>

    <!-- Benefits: Visites mystères -->
    <section class="benefits-section" id="benefit-2" style="background-color: #F0F7F6;">
      <div class="benefits-container">
        <h2 class="benefits-title" style="color: #504C54;">
          Pour vos <span class="benefit-highlight" style="color: #75898A;">clients<img src="/images/services/benefits-section/subline-clients.png" alt="" class="subline-img" /></span> : une vision réelle de <span class="benefit-highlight" style="color: #75898A;">l'expérience<img src="/images/services/benefits-section/subline-expérience.png" alt="" class="subline-img" /></span> vécue
        </h2>
        <div class="benefits-content image-left">
          <div class="benefits-text">
            <h3 class="section-title">Visites mystères</h3>
            <p class="description">Les visites mystère Smice permettent d'évaluer la qualité perçue par vos clients réels. Réalisées par des profils ciblés et représentatifs de votre clientèle, elles mesurent l'accueil, le service et la cohérence du parcours client.</p>
            <p class="description">Les résultats restitués sur la plateforme Smice offrent une vision concrète de l'expérience vécue et des leviers d'amélioration.</p>
            <a href="/services/visite-mystere" class="btn-benefit" style="background-color: #75898A;">En savoir plus</a>
          </div>
          <div class="benefits-image">
            <img src="/images/services/benefits-section/visitesmystère.png" alt="Visites mystères" />
          </div>
        </div>
      </div>
    </section>

    <!-- Benefits: Analyse des résultats -->
    <section class="benefits-section" id="benefit-3" style="background-color: #F4F7FF;">
      <div class="benefits-container">
        <h2 class="benefits-title" style="color: #504C54;">
          Pour vos <span class="benefit-highlight" style="color: #6989D4;">résultats<img src="/images/services/benefits-section/subline-résultats.png" alt="" class="subline-img" /></span> : une <span class="benefit-highlight" style="color: #6989D4;">compréhension<img src="/images/services/benefits-section/subline-compréhension.png" alt="" class="subline-img" /></span> approfondie et utile
        </h2>
        <div class="benefits-content">
          <div class="benefits-text">
            <h3 class="section-title">Analyse des résultats</h3>
            <p class="description">Nos équipes d'analystes transforment vos données en insights actionnables.</p>
            <p class="description">Nous réalisons des rapports détaillés, des analyses approfondies, des synthèses par région ou par typologie de site, ainsi que des recommandations opérationnelles.</p>
            <a href="/services/audit" class="btn-benefit" style="background-color: #6989D4;">En savoir plus</a>
          </div>
          <div class="benefits-image">
            <img src="/images/services/benefits-section/analyse-résultats.png" alt="Analyse des résultats" />
          </div>
        </div>
      </div>
    </section>

    <Testimonials 
      backgroundColor="linear-gradient(180deg, #E8EDF8 0%, #F5F7FF 100%)"
      sublineImage="/images/services/testimonials-section/subline-confiance.png"
    />

    <Contact decorationColor="#FAD917" />
  </main>
  
  <Footer />
</Layout>

<style>
  /* ===== Shared Subline Image Style ===== */
  .subline-img {
    position: absolute;
    bottom: 3px;
    left: 0;
    width: 100%;
    height: auto;
    pointer-events: none;
  }

  /* ===== Hero Section ===== */
  .services-hero {
    padding: 120px 24px 80px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .hero-banner {
    position: relative;
    max-width: 1224px;
    width: 100%;
    height: 560px;
    border-radius: 16px;
    overflow: hidden;
    background-image: url('/images/services/hero-section/banner.png');
    background-size: cover;
    background-position: center;
    background-blend-mode: darken;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .hero-overlay {
    position: absolute;
    inset: 0;
    background: radial-gradient(ellipse at center, rgba(30, 30, 60, 0.55) 0%, rgba(20, 20, 45, 0.8) 100%);
    backdrop-filter: blur(24px);
  }

  .hero-content {
    position: relative;
    z-index: 1;
    text-align: center;
    padding: 60px 40px;
    max-width: 900px;
  }

  .hero-title {
    font-size: 42px;
    font-weight: 800;
    color: #FFFFFE;
    margin: 0 0 24px 0;
    line-height: 1.3;
  }

  .hero-title .highlight {
    color: #FAD917;
    position: relative;
    display: inline-block;
  }

  .hero-description {
    font-size: 20px;
    font-weight: 700;
    color: #FFFFFE;
    line-height: 1.6;
    margin: 0 0 32px 0;
    text-align: center;
  }

  .hero-cta {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 240px;
    height: 45px;
    padding: 8px 16px;
    gap: 8px;
    background: #FFFFFE;
    color: #435888;
    font-size: 18px;
    font-weight: 600;
    border-radius: 6px;
    text-decoration: none;
    transition: all 0.3s ease;
  }

  .hero-cta:hover {
    background: #f0f0f0;
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(67, 88, 136, 0.2);
  }

  /* ===== Solution Section ===== */
  .solution-section {
    padding: 100px 24px;
  }

  .solution-container {
    max-width: 1224px;
    margin: 0 auto;
  }

  .solution-title {
    font-size: 40px;
    font-weight: 800;
    color: #435888;
    text-align: center;
    margin: 0 0 60px 0;
  }

  .solution-title .solution-highlight {
    color: #6989D4;
    position: relative;
    display: inline-block;
  }

  /* ===== Carousel ===== */
  .carousel-wrapper {
    display: flex;
    align-items: center;
    gap: 24px;
  }

  .carousel-btn {
    flex-shrink: 0;
    width: 56px;
    height: 56px;
    border-radius: 50%;
    border: 2px solid #E5E7EB;
    background: white;
    color: #435888;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
  }

  .carousel-btn:hover {
    border-color: #6989D4;
    color: #6989D4;
  }

  .carousel-btn:disabled {
    opacity: 0.3;
    cursor: not-allowed;
  }

  .steps-carousel {
    flex: 1;
    overflow: hidden;
  }

  .steps-track {
    display: flex;
    transition: transform 0.5s ease;
  }

  .step-slide {
    flex: 0 0 100%;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 60px;
    align-items: start;
    padding: 0 20px;
  }

  .step-image {
    display: flex;
    justify-content: center;
    padding-top: 20px;
  }

  .image-wrapper {
    width: 100%;
    max-width: 450px;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.1);
  }

  .image-wrapper img {
    width: 100%;
    height: auto;
    object-fit: cover;
    display: block;
  }

  .step-content {
    max-width: 500px;
  }

  .step-label {
    display: inline-block;
    font-size: 20px;
    font-weight: 700;
    color: #FAD917;
    margin-bottom: 12px;
  }

  .step-title {
    font-size: 32px;
    font-weight: 800;
    color: #435888;
    margin: 0 0 16px 0;
    line-height: 1.3;
  }

  .step-description {
    margin: 0 0 16px 0;
  }

  .step-description p {
    font-size: 16px;
    font-weight: 500;
    color: #7C797F;
    line-height: 1.7;
    margin: 0 0 12px 0;
  }

  .objectif-section {
    margin-top: 16px;
    padding-top: 16px;
    border-top: 1px solid rgba(124, 121, 127, 0.15);
  }

  .objectif-text {
    font-size: 16px;
    font-weight: 500;
    color: #7C797F;
    margin: 0 0 8px 0;
  }

  .objectif-highlight {
    color: #6989D4;
    font-weight: 800;
  }

  .step-bullets {
    margin: 0;
    padding-left: 20px;
  }

  .step-bullets li {
    font-size: 16px;
    font-weight: 500;
    color: #7C797F;
    line-height: 1.8;
    margin-bottom: 8px;
  }

  .step-bullets li:last-child {
    margin-bottom: 0;
  }

  /* Carousel Dots */
  .carousel-dots {
    display: flex;
    justify-content: center;
    gap: 12px;
    margin-top: 40px;
  }

  .dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    border: none;
    background: #E5E7EB;
    cursor: pointer;
    transition: all 0.3s ease;
    padding: 0;
  }

  .dot:hover {
    background: #9CA3AF;
  }

  .dot.active {
    background: #6989D4;
    width: 32px;
    border-radius: 6px;
  }

  /* ===== Benefits Sections ===== */
  .benefits-section {
    padding: 80px 24px;
  }

  .benefits-container {
    max-width: 1100px;
    margin: 0 auto;
  }

  .benefits-title {
    font-size: 40px;
    font-weight: 800;
    text-align: center;
    margin: 0 0 50px 0;
    line-height: 1.3;
  }

  .benefit-highlight {
    position: relative;
    display: inline-block;
  }

  .benefits-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 60px;
    align-items: center;
  }

  .benefits-content.image-left .benefits-image {
    order: -1;
  }

  .benefits-text {
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .section-title {
    font-size: 32px;
    font-weight: 800;
    color: #504C54;
    margin: 0;
  }

  .description {
    font-size: 18px;
    font-weight: 500;
    line-height: 1.7;
    color: #7C797F;
    margin: 0;
  }

  .btn-benefit {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 173px;
    height: 45px;
    padding: 8px 24px;
    gap: 8px;
    color: white;
    font-size: 16px;
    font-weight: 600;
    border-radius: 6px;
    text-decoration: none;
    transition: all 0.3s ease;
    align-self: flex-start;
    margin-top: 8px;
  }

  .btn-benefit:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
  }

  .benefits-image {
    width: 100%;
    border-radius: 16px;
    overflow: hidden;
  }

  .benefits-image img {
    width: 100%;
    height: auto;
    object-fit: cover;
    display: block;
  }

  /* ===== Tablet Responsive ===== */
  @media (max-width: 1024px) {
    .hero-banner {
      height: 450px;
    }

    .hero-title {
      font-size: 34px;
    }

    .hero-description {
      font-size: 18px;
    }

    .solution-title {
      font-size: 34px;
    }

    .step-slide {
      gap: 40px;
    }

    .step-title {
      font-size: 26px;
    }

    .benefits-title {
      font-size: 34px;
    }

    .section-title {
      font-size: 26px;
    }

    .benefits-content {
      gap: 40px;
    }
  }

  /* ===== Mobile Responsive ===== */
  @media (max-width: 768px) {
    .services-hero {
      padding: 100px 16px 60px;
    }

    .hero-banner {
      height: 400px;
      border-radius: 12px;
    }

    .hero-content {
      padding: 40px 24px;
    }

    .hero-title {
      font-size: 28px;
    }

    .hero-description {
      font-size: 16px;
      margin: 0 0 24px 0;
    }

    .hero-cta {
      width: 220px;
      height: 42px;
      font-size: 16px;
    }

    .solution-section {
      padding: 60px 16px;
    }

    .solution-title {
      font-size: 28px;
      margin-bottom: 40px;
    }

    .carousel-wrapper {
      flex-direction: column;
      gap: 32px;
    }

    .carousel-btn {
      display: none;
    }

    .step-slide {
      grid-template-columns: 1fr;
      gap: 32px;
      padding: 0 10px;
    }

    .step-content {
      max-width: 100%;
      text-align: center;
    }

    .step-bullets {
      text-align: left;
      display: inline-block;
    }

    .step-title {
      font-size: 24px;
    }

    .step-label {
      font-size: 18px;
    }

    .benefits-section {
      padding: 60px 20px;
    }

    .benefits-title {
      font-size: 28px;
      margin-bottom: 40px;
    }

    .benefits-content {
      grid-template-columns: 1fr;
      gap: 30px;
    }

    .benefits-content.image-left .benefits-image {
      order: 0;
    }

    .section-title {
      font-size: 24px;
    }

    .description {
      font-size: 16px;
    }

    .btn-benefit {
      align-self: center;
    }
  }

  /* ===== Small Mobile ===== */
  @media (max-width: 480px) {
    .hero-title {
      font-size: 24px;
    }

    .hero-description {
      font-size: 14px;
    }

    .solution-title {
      font-size: 24px;
    }

    .benefits-title {
      font-size: 24px;
    }

    .section-title {
      font-size: 22px;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const track = document.querySelector('.steps-track') as HTMLElement;
    const slides = document.querySelectorAll('.step-slide');
    const prevBtn = document.querySelector('.prev-btn') as HTMLButtonElement;
    const nextBtn = document.querySelector('.next-btn') as HTMLButtonElement;
    const dots = document.querySelectorAll('.dot');
    
    if (!track || !prevBtn || !nextBtn) return;

    let currentIndex = 0;
    const totalSlides = slides.length;

    function updateCarousel() {
      track.style.transform = `translateX(-${currentIndex * 100}%)`;
      
      dots.forEach((dot, index) => {
        dot.classList.toggle('active', index === currentIndex);
      });
      
      prevBtn.disabled = currentIndex === 0;
      nextBtn.disabled = currentIndex === totalSlides - 1;
    }

    function goToSlide(index: number) {
      currentIndex = Math.max(0, Math.min(index, totalSlides - 1));
      updateCarousel();
    }

    prevBtn.addEventListener('click', () => {
      goToSlide(currentIndex - 1);
    });

    nextBtn.addEventListener('click', () => {
      goToSlide(currentIndex + 1);
    });

    dots.forEach((dot, index) => {
      dot.addEventListener('click', () => {
        goToSlide(index);
      });
    });

    // Touch/swipe support
    let touchStartX = 0;
    let touchEndX = 0;
    const carousel = document.querySelector('.steps-carousel');
    
    if (carousel) {
      carousel.addEventListener('touchstart', (e: Event) => {
        touchStartX = (e as TouchEvent).changedTouches[0].screenX;
      });

      carousel.addEventListener('touchend', (e: Event) => {
        touchEndX = (e as TouchEvent).changedTouches[0].screenX;
        const diff = touchStartX - touchEndX;
        if (Math.abs(diff) > 50) {
          if (diff > 0) goToSlide(currentIndex + 1);
          else goToSlide(currentIndex - 1);
        }
      });
    }

    updateCarousel();
  });
</script>
